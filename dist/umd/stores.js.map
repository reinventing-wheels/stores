{"version":3,"file":"stores.js","sources":["../../src/classes/adapters/LocalStorageAdapter.ts","../../src/classes/ExtendedArray.ts","../../src/classes/stores/ArrayStore.ts","../../src/classes/stores/MapStore.ts","../../src/classes/stores/SetStore.ts"],"sourcesContent":["import { Adapter } from '../../interfaces'\n\nexport class LocalStorageAdapter implements Adapter {\n  constructor(private readonly key: string) {}\n\n  async read(def: any) {\n    const json = localStorage.getItem(this.key)\n    return json ? JSON.parse(json) : def\n  }\n\n  async write(obj: any) {\n    const json = JSON.stringify(obj)\n    localStorage.setItem(this.key, json)\n  }\n}\n","export class ExtendedArray<V> extends Array<V> {\n  get size() {\n    return this.length\n  }\n\n  has(value: V) {\n    return this.includes(value)\n  }\n\n  get(index: number): V | undefined {\n    return this[index]\n  }\n\n  set(index: number, value: V) {\n    this[index] = value\n    return this\n  }\n\n  add(value: V) {\n    this.push(value)\n    return this\n  }\n\n  delete(index: number) {\n    return !!this.splice(index, 1).length\n  }\n\n  clear() {\n    this.splice(0)\n  }\n}\n","import { Store, Adapter } from '../../interfaces'\nimport { ExtendedArray } from '../ExtendedArray'\n\nexport class ArrayStore<V = any> extends ExtendedArray<V> implements Store {\n  constructor(private readonly adapter: Adapter) {\n    super()\n  }\n\n  async load() {\n    for (const v of await this.adapter.read([]))\n      this.push(v)\n    return this\n  }\n\n  async save() {\n    await this.adapter.write(this)\n    return this\n  }\n}\n","import { Store, Adapter } from '../../interfaces'\n\nexport class MapStore<K = any, V = any> extends Map<K, V> implements Store {\n  constructor(private readonly adapter: Adapter) {\n    super()\n  }\n\n  async load() {\n    for (const [k, v] of await this.adapter.read([]))\n      this.set(k, v)\n    return this\n  }\n\n  async save() {\n    await this.adapter.write([...this])\n    return this\n  }\n}\n","import { Store, Adapter } from '../../interfaces'\n\nexport class SetStore<V = any> extends Set<V> implements Store {\n  constructor(private readonly adapter: Adapter) {\n    super()\n  }\n\n  async load() {\n    for (const v of await this.adapter.read([]))\n      this.add(v)\n    return this\n  }\n\n  async save() {\n    await this.adapter.write([...this])\n    return this\n  }\n}\n"],"names":[],"mappings":"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"}